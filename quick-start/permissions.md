# 🔑 必要權限設定

## 🛡️ **機器人權限總覽**

Sigma Bot 需要以下核心權限才能正常運作。這些權限經過精心設計，確保功能完整性同時維護伺服器安全。

---

## 📋 **權限分類說明**

### 🔒 **管理權限 (高敏感度)**

#### 👥 **成員管理**
| 權限 | 用途 | 必要性 |
|------|------|--------|
| `管理成員` | 禁言、解除禁言用戶 | 🔴 必要 |
| `踢除成員` | 移除違規用戶 | 🔴 必要 |
| `封鎖成員` | 永久封鎖嚴重違規者 | 🔴 必要 |
| `管理暱稱` | 修改不當暱稱 | 🟡 建議 |

#### 📝 **訊息管理**
| 權限 | 用途 | 必要性 |
|------|------|--------|
| `管理訊息` | 刪除違規內容、置頂訊息 | 🔴 必要 |
| `讀取訊息歷史` | 查看過往訊息進行審核 | 🔴 必要 |
| `添加反應` | 反應身分組、投票功能 | 🟡 建議 |

#### 🎭 **身分組管理**
| 權限 | 用途 | 必要性 |
|------|------|--------|
| `管理身分組` | 自動分配身分組、權限管理 | 🟡 建議 |
| `提及所有人` | 重要公告通知 | 🟢 可選 |

### 🗣️ **語音權限**

#### 🎵 **音樂功能**
| 權限 | 用途 | 必要性 |
|------|------|--------|
| `連接語音` | 加入語音頻道播放音樂 | 🔴 必要 |
| `在語音頻道中說話` | 播放音樂和音效 | 🔴 必要 |
| `使用語音活動` | 檢測語音活動狀態 | 🟡 建議 |
| `移動成員` | 高級語音管理功能 | 🟢 可選 |

### 💬 **文字權限**

#### 📤 **基本通信**
| 權限 | 用途 | 必要性 |
|------|------|--------|
| `查看頻道` | 讀取和回應指令 | 🔴 必要 |
| `發送訊息` | 回應指令和發送通知 | 🔴 必要 |
| `嵌入連結` | 顯示豐富內容 (embed) | 🔴 必要 |
| `附加檔案` | 分享圖片、音樂檔案 | 🟡 建議 |
| `使用外部表情符號` | 顯示自訂表情符號 | 🟢 可選 |

#### 📢 **進階通信**
| 權限 | 用途 | 必要性 |
|------|------|--------|
| `提及所有人` | 緊急公告通知 | 🟢 可選 |
| `使用斜線指令` | 現代化指令系統 | 🔴 必要 |
| `創建公開討論串` | 組織討論和活動 | 🟢 可選 |

---

## ⚙️ **權限配置指南**

### 🎯 **推薦配置：完整功能**

如果您希望 Sigma Bot 發揮全部潛力，建議授予以下權限組合：

#### ✅ **核心權限組合**
```
📋 基本權限：
✅ 查看頻道
✅ 發送訊息  
✅ 嵌入連結
✅ 讀取訊息歷史
✅ 使用斜線指令

🛡️ 管理權限：
✅ 管理訊息
✅ 管理成員
✅ 踢除成員
✅ 封鎖成員

🎵 語音權限：
✅ 連接語音
✅ 在語音頻道中說話
```

### 🔒 **最小權限配置**

如果您只需要基本功能，可以使用以下最小權限組合：

#### 📝 **基本功能組合**
```
✅ 查看頻道
✅ 發送訊息
✅ 嵌入連結
✅ 使用斜線指令
✅ 添加反應
```

⚠️ **注意**：最小權限配置下，管理、音樂和自動化功能將無法使用。

---

## 🚨 **權限安全建議**

### 🛡️ **安全最佳實踐**

#### 1. **身分組層級管理**
- 確保機器人身分組位置合適
- 機器人只能管理**位置較低**的身分組
- 建議將機器人身分組放在版主之下、一般成員之上

#### 2. **頻道權限覆蓋**
- 在敏感頻道中可以移除機器人的特定權限
- 管理員專用頻道建議移除機器人的 `查看頻道` 權限
- 重要公告頻道可以移除 `管理訊息` 權限

#### 3. **定期權限審核**
```
/permissions check    # 檢查目前權限配置
/security audit       # 執行安全審核
/health               # 檢查系統狀態
```

### ⚠️ **權限風險說明**

#### 🔴 **高風險權限**
- `管理員` - **強烈不建議**授予，會繞過所有權限檢查
- `管理伺服器` - **不需要**，機器人不需要修改伺服器設定
- `管理 Webhook` - **不需要**，機器人不使用 Webhook 功能

#### 🟡 **中風險權限**
- `管理頻道` - 僅在需要動態創建頻道時授予
- `查看審核日誌` - 用於安全分析，但包含敏感資訊

---

## 🔧 **權限故障排除**

### ❓ **常見權限問題**

#### **問題 1：指令無回應**
**可能原因**：
- 缺少 `查看頻道` 或 `發送訊息` 權限
- 機器人被頻道權限覆蓋阻止

**解決方案**：
1. 檢查頻道權限設定
2. 確認機器人身分組有基本權限
3. 使用 `/ping` 測試連接

#### **問題 2：管理指令失敗**
**可能原因**：
- 缺少對應管理權限
- 嘗試管理更高等級的用戶

**解決方案**：
1. 確認機器人有 `管理成員`、`踢除成員` 等權限
2. 檢查身分組層級關係
3. 使用 `/permissions check` 診斷

#### **問題 3：音樂功能無法使用**
**可能原因**：
- 缺少語音權限
- 語音頻道有特殊限制

**解決方案**：
1. 授予 `連接語音` 和 `在語音頻道中說話` 權限
2. 檢查語音頻道用戶限制
3. 確認沒有被頻道權限覆蓋阻止

### 🛠️ **權限診斷工具**

#### 📊 **內建診斷指令**
```
/permissions check user:@用戶        # 檢查特定用戶權限
/permissions list                    # 列出所有權限配置  
/health permissions                  # 權限健康檢查
/security validate                   # 安全配置驗證
```

#### 🔍 **手動檢查步驟**
1. **伺服器設定** → **身分組**
2. 找到機器人身分組
3. 檢查 **權限** 標籤下的設定
4. 對比本指南的建議配置

---

## 📞 **獲得協助**

如果您在權限配置過程中遇到問題：

### 🆘 **支援管道**
- **[💬 加入支援伺服器](https://discord.gg/dnvKBk6V4y)** - 即時協助
- **使用 `/globalreport`** - 向開發團隊報告問題
- **查看 [🚨 故障排除](../troubleshooting/faq.md)** - 常見問題解答

### 📝 **報告問題時請提供**
- 具體的錯誤訊息
- 當前的權限配置截圖
- 嘗試使用的指令
- 伺服器規模和設定資訊

---

*權限設定指南最後更新：2025年7月30日*  
*Sigma Bot v2.0.0*